# 7.1 생체신호 처리와 정보검출: 시간-주파수 신호의 이해와 필터링

## 개요

필터를 보다 잘 이해하기 위해서는 시간-주파수의 관계를 이해해야 합니다. 생체신호는 복잡한 주파수 성분들로 구성되어 있으며, 원하는 정보를 추출하기 위해서는 적절한 필터링 기법이 필수적입니다.

## 1. 시간-주파수 신호의 이해

### 주파수의 정의

- **주파수(Frequency)**: 1초당 진동 횟수
  - 단위: Hz (Hertz)
  - 계산: 1/주기(Period)
  - 생체신호는 각각 고유한 주파수 특성을 가짐

### 자연계 신호의 특성

- **복합 신호**: 자연계의 모든 신호는 다양한 주파수가 섞여 있음
- **시간 영역의 한계**: 시간 영역에서만 보면 어떤 주파수 성분이 포함되어 있는지 알기 어려움

```
  2 |     /\      /\      /\
  1 |    /  \    /  \    /  \
  0 |---/----\--/----\--/----\---
 -1 |   \    /  \    /  \    /
 -2 |    \/      \/      \/
     ------------------------ 시간(s)
    0.1  0.3  0.5  0.7  0.9
```

### 주파수 분석의 필요성

- **신호 분리**: 어떤 신호가 섞여 있는지 알아야 불필요한 신호를 걸러낼 수 있음
- **노이즈 제거**: 원하는 신호와 노이즈의 주파수 특성이 다르면 필터링으로 분리 가능
- **특징 추출**: 특정 주파수 대역의 정보만 선택적으로 분석

### Fourier Series/Transform (퓨리에 급수/변환)

#### 기본 원리
- **핵심 개념**: 모든 신호는 주파수가 서로 다른 (복소)정현파의 합으로 표현할 수 있음

**예시**: 복합 신호 분해
```
이 신호는:
- 크기가 1인 1Hz 사인파
- 크기가 0.7인 2Hz 사인파  
- 크기가 0.5인 10Hz 사인파
의 합으로 구성됨
```

#### 생체신호에서의 활용

생체신호들은 각각 고유한 주파수 대역을 가지며, 일부 겹치기도 합니다:

- **심전도(ECG)**: 0.1 ~ 대략 200Hz의 정현파들의 조합으로 구성
- **근전도(EMG)**: 25 ~ 수천Hz의 정현파들의 조합으로 구성
- **뇌전도(EEG)**: 0.5 ~ 100Hz 범위

**필터링의 중요성**: 원하는 생체신호 측정을 위해 해당 신호의 주파수 대역으로 필터링이 필요

### 오일러 공식 (Euler's Formula)

복소수로 표현하면 크기와 위상을 나누어 표현할 수 있습니다:

#### 기본 공식
```
e^(jθ) = cos(θ) + j·sin(θ)
```

#### 복소수 표현
```
c = a + jb
|c| = √(a² + b²)    (크기)
θ = tan⁻¹(b/a)      (위상)
c = |c|e^(jθ)
```

#### 삼각함수와의 관계
```
cos(θ) = (e^(jθ) + e^(-jθ))/2
sin(θ) = (e^(jθ) - e^(-jθ))/(2j)
```

### 퓨리에 급수 변환 예시

**원본 신호**:
```
x(t) = 10 + 3cos(ω₀t) + 5cos(2ω₀t + π/6) + 4sin(3ω₀t)
```

**삼각함수를 복소지수로 변환**:
```
cos(θ) = (e^(jθ) + e^(-jθ))/2
sin(θ) = (e^(jθ) - e^(-jθ))/(2j)
```

**복소지수 형태로 표현**:
```
x(t) = 10 + (3/2)[e^(jω₀t) + e^(-jω₀t)] + 
       (5/2)[e^(j(2ω₀t+π/6)) + e^(-j(2ω₀t+π/6))] + 
       (4/2j)[e^(j3ω₀t) - e^(-j3ω₀t)]
```

**퓨리에 급수 계수**:
- X[-3] = 2∠(-90°) = -2j
- X[-2] = (5/2)∠(-30°)  
- X[-1] = 3/2
- X[0] = 10
- X[1] = 3/2
- X[2] = (5/2)∠30°
- X[3] = 2∠90° = 2j

**일반적인 퓨리에 급수 형태**:
```
x(t) = Σ(k=-3 to 3) X[k]e^(jkω₀t)
```

**중요한 특성**: X[k]는 X[0]을 중심으로 대칭

### 퓨리에 급수/변환의 결론

어떤 주기적인 신호는 기본 주파수의 정수배가 되는 주파수를 갖는 복소 정현파들의 합으로 표현할 수 있습니다.

## 2. 필터의 이해

### 주파수 영역에서의 필터링

**필터링 과정**:
```
시간 영역:   x(t) → [필터] → y(t)
               ↓         ↑
주파수 영역: X[k] → ×H[k] → Y[k]
             (퓨리에 변환)  (퓨리에 역변환)
```

**수학적 표현**:
```
Y[k] = X[k] × H[k]
```

### 시간-주파수 관계의 핵심

**중요한 관계식**:
```
시간 영역에서 필터링은 합성곱 (Convolution)
주파수 영역에서 필터링은 곱셈 (Multiplication)

x[n] * y[n] ↔ N·X[k]·Y[k]
```

**수학적 증명 과정** (간략화):
```
z(t) = x(t) * y(t) = ∫₀ᵀ x(τ)y(t-τ)dτ

Z[k] = (1/T)∫₀ᵀ z(t)e^(-jkω₀t)dt
     = (1/T)∫₀ᵀ ∫₀ᵀ x(τ)y(t-τ)e^(-jkω₀t)dτdt
     = T·Y[k]·X[k]
```

### 필터의 형태 변환

**주파수 영역 vs 시간 영역**:
- 주파수 영역에서 필터는 박스 형태 (이상적인 저역통과 필터)
- 시간 영역에서는 sinc function 형태

```
주파수 영역:  ┌─────┐
             │     │
         ────┴─────┴──── 주파수

시간 영역:      ∩
            ╱   ╲
         ╱─┼─────┼─╲
       ╱   │     │   ╲
     ────────────────────── 시간
```

### 시간 영역에서의 필터링

**시스템 표현**:
```
x[n] → [필터 H] → y[n]
y[n] = H{x[n]}
```

**임펄스 응답을 이용한 표현**:
```
y[t] = H{x[t]}
     = H{Σ x[k]δ[t-k]}
     = Σ x[k]H{δ[t-k]}
     = Σ x[k]h[t-k]
     = x[t] * h[t]
```

### 합성곱 (Convolution)

**정의**: 
```
y[n] = x[n] * h[n] = Σ x[k]h[n-k] = Σ h[k]x[n-k]
```

**물리적 의미**:
- 현재 출력은 과거 입력값들의 가중합
- 가중치는 필터의 임펄스 응답 h[n]으로 결정

## 3. 디지털 필터의 종류

### FIR (Finite Impulse Response) 필터

**정의**: 유한한 길이의 임펄스 응답을 가지는 필터

**수학적 표현**:
```
y[n] = Σ(k=0 to N) h[k]x[n-k]
```

**특징**:
- **안정성**: 항상 안정함
- **선형 위상**: 모든 주파수에서 동일한 지연
- **설계 용이**: 원하는 주파수 응답 구현이 비교적 쉬움

### IIR (Infinite Impulse Response) 필터

**정의**: 무한한 길이의 임펄스 응답을 가지는 필터

**수학적 표현**:
```
y[n] = Σ(k=0 to N) b[k]x[n-k] - Σ(k=1 to M) a[k]y[n-k]
```
여기서 a[k], b[k]는 필터 계수

**특징**:
- **피드백 구조**: 출력이 다시 입력으로 사용
- **효율성**: 낮은 차수로도 우수한 성능

### FIR vs IIR 필터 비교

| 특성 | FIR | IIR |
|------|-----|-----|
| **안정성** | 항상 안정 | 설계에 따라 불안정 가능 |
| **위상 특성** | 선형 위상 가능 | 일반적으로 비선형 위상 |
| **메모리 요구량** | 높음 | 낮음 |
| **연산량** | 높음 | 낮음 |
| **설계 복잡도** | 간단 | 복잡 (안정성 고려) |

## 4. 생체신호 처리에서의 필터 응용

### 주요 생체신호별 특성

- **심전도(ECG)**: 0.1~200Hz, 전원선 간섭 및 근전도 노이즈 제거 필요
- **근전도(EMG)**: 25~수천Hz, 움직임 아티팩트 제거 필요  
- **뇌전도(EEG)**: 0.5~100Hz, 안구 움직임 및 근육 활동 노이즈 제거 필요

### 필터 설계 고려사항

- **통과대역**: 원하는 신호의 주파수 범위
- **차단대역**: 제거하고자 하는 노이즈의 주파수 범위
- **실시간 처리**: 지연 시간 최소화
- **계산 복잡도**: 하드웨어 제약 고려

## 5. 요약

- **시간-주파수 관계**: 퓨리에 변환을 통한 영역 간 변환
- **필터링 원리**: 시간 영역의 합성곱 = 주파수 영역의 곱셈
- **FIR vs IIR**: 각각 고유한 장단점, 응용에 따른 선택
- **생체신호 처리**: 신호별 특성을 고려한 적절한 필터 설계 중요

이러한 신호처리 기술은 HCI 분야에서 생체신호 기반 감성 인식, 뇌-컴퓨터 인터페이스, 생체 인증 등 다양한 응용에 핵심적인 역할을 합니다.
